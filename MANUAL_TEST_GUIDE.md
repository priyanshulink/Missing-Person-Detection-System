# üß™ Manual Test Guide - Face Encoding Upload

## ‚úÖ Test Face Encoding via Web Dashboard

### **Step 1: Open Dashboard**
The browser should have opened automatically to: **http://localhost:8080**

If not, open it manually.

---

### **Step 2: Login**
```
Username: ompriyanshu12@gmail.com
Password: pradeep3133
```

Click "Login"

---

### **Step 3: Go to Persons Tab**
- Click on **"Persons"** in the navigation menu

---

### **Step 4: Add a New Person**
1. Click the **"Add Person"** button
2. A modal will open

---

### **Step 5: Capture Photo from Webcam**
1. Click **"Capture from Webcam"** button
2. Browser will ask for camera permission - **Click "Allow"**
3. Your webcam will open
4. Position your face in the frame
5. Click **"Capture"** button
6. The photo will appear as a preview

**Alternative:** Click "Upload Photo" to select an image file from your computer

---

### **Step 6: Fill Person Details**
```
Name: Test Person
Age: 30
Gender: male
Status: missing
Priority: high
Description: Testing face encoding upload
```

---

### **Step 7: Save**
Click the **"Save"** button

---

### **Step 8: Watch for Success**
You should see:
- ‚úÖ "Person added successfully with face encoding!"
- The person appears in the persons list

---

## üîç Verify Face Encoding in Database

### **Method 1: Check in Dashboard**
1. Look at the persons list
2. Find "Test Person"
3. The card should show the person's details

---

### **Method 2: Check MongoDB Directly**

Open a new terminal and run:

```bash
# Connect to MongoDB
mongo mongodb://localhost:27017/person_detection

# Query the person
db.persons.findOne({name: "Test Person"})
```

**Expected Output:**
```javascript
{
    "_id" : ObjectId("..."),
    "name" : "Test Person",
    "age" : 30,
    "status" : "missing",
    "faceEncodings" : [
        {
            "encoding" : [
                0.123456,
                -0.234567,
                0.345678,
                // ... 125 more numbers (128 total)
                0.987654
            ],
            "imageUrl" : "/uploads/person-1697123456789.jpg",
            "uploadedAt" : ISODate("2025-10-14T13:15:00.000Z"),
            "_id" : ObjectId("...")
        }
    ],
    "createdAt" : ISODate("2025-10-14T13:15:00.000Z"),
    // ... other fields
}
```

---

### **Method 3: Check Uploaded File**

Navigate to:
```
c:\Users\91900\Downloads\project\backend-api\uploads\
```

You should see a file like: `person-1697123456789-123456789.jpg`

---

## ‚úÖ Success Checklist

Check these to confirm face encoding is working:

- [ ] Photo captured/uploaded successfully
- [ ] Person appears in persons list
- [ ] No error messages shown
- [ ] File exists in `backend-api/uploads/` folder
- [ ] MongoDB document has `faceEncodings` array
- [ ] Encoding array has exactly **128 numbers**
- [ ] All encoding values are floating-point numbers

---

## üéØ What Happens Behind the Scenes

When you click "Save":

```
1. Frontend sends photo to: POST /api/upload/person-photo
   ‚Üì
2. Backend saves file to: backend-api/uploads/person-xxx.jpg
   ‚Üì
3. Backend calls Python: python extract_encoding.py <image_path>
   ‚Üì
4. Python uses face_recognition library:
   - Detects face in image
   - Generates 128D encoding: [0.123, -0.456, ..., 0.789]
   ‚Üì
5. Python returns JSON: {"success": true, "encoding": [...]}
   ‚Üì
6. Backend returns encoding to frontend
   ‚Üì
7. Frontend creates person: POST /api/persons
   Body: { name: "...", faceEncodings: [{encoding: [...]}] }
   ‚Üì
8. MongoDB stores document with 128D encoding array
   ‚Üì
9. ‚úÖ DONE! Face encoding stored in database
```

---

## üî¢ Understanding the 128D Encoding

The encoding looks like this:
```javascript
[
  0.123456,    // Dimension 1
  -0.234567,   // Dimension 2
  0.345678,    // Dimension 3
  -0.456789,   // Dimension 4
  // ... 124 more numbers
  0.987654     // Dimension 128
]
```

**What it represents:**
- Mathematical representation of facial features
- Generated by deep learning neural network
- Unique for each person's face
- Used for matching during surveillance

---

## üé• Test Real-Time Matching

After adding the person:

1. **Surveillance should be running** (started automatically on login)
2. **Show your face to the webcam**
3. **System will detect and match** against stored encoding
4. **Alert will appear** in the "Alerts" tab
5. **Report will be created** in the "Reports" tab

---

## üìä View Test Results

### **In Dashboard:**
1. Go to **"Persons"** tab ‚Üí See "Test Person"
2. Go to **"Alerts"** tab ‚Üí See detection alerts
3. Go to **"Reports"** tab ‚Üí See detection reports

### **In Browser Console:**
1. Press **F12** to open Developer Tools
2. Go to **"Console"** tab
3. Look for messages like:
   ```
   Face encoding extracted successfully
   Person created: {_id: "...", name: "Test Person", ...}
   ```

### **In Backend Terminal:**
Look for logs like:
```
üì∏ Photo upload request received
‚úÖ File saved to: /uploads/person-1697123456789.jpg
üîç Extracting face encoding...
‚úÖ Face encoding extracted successfully
```

---

## üêõ Common Issues

### **"No face detected in image"**
**Solution:**
- Ensure face is clearly visible
- Use good lighting
- Face should be front-facing
- Try a different photo

### **"Camera permission denied"**
**Solution:**
- Click the camera icon in browser address bar
- Allow camera access
- Refresh the page

### **"Upload failed"**
**Solution:**
- Check backend is running: `http://localhost:3000/health`
- Check browser console for errors (F12)
- Check backend terminal for error messages

---

## üéâ Success!

If you see:
- ‚úÖ "Person added successfully with face encoding!"
- ‚úÖ Person in the list
- ‚úÖ 128 numbers in database

**Your face encoding system is working perfectly!** üöÄ

The system is now ready to:
- Detect faces in real-time
- Match against stored encodings
- Send alerts when persons are found

---

**Next:** Try showing your face to the webcam and watch the surveillance system detect you!
